<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Toast & Tales | A Kopi Heritage Journey</title>
    
    <link rel="stylesheet" href="homepage.css">
</head>
<body>

    <nav>
        <div class="logo">Toast & Tales</div>
        <div class="nav-links">
            <a href="contactus.html" class="nav-btn">Contact Us</a>
            <a href="#" class="nav-btn login-btn" onclick="openLogin()">Log In</a>
            
            <a href="user.html" id="userLink" class="user-link" style="display: none;" title="Open profile">
                <div id="userIcon" class="user-icon">U</div>
            </a>
        </div>
    </nav>

    <div class="carousel-container">
        <div class="hero-text">
            <h1>Relive the Heritage</h1>
            <p>Experience the art of Kopi & Kaya in Augmented Reality.</p>
        </div>
        
        <div class="slide active">
            <img src="images/yakun1.png" alt="Ya Kun Kopi">
        </div> 
        
        <div class="slide">
            <img src="images/yakun2.png" alt="Ya Kun Toast">
        </div>

        <div class="slide">
            <img src="images/yakun3.jpg" alt="Ya Kun Set">
        </div>
    </div>

    <section id="about-game">
        <div class="section-header">
            <h2>About Toast & Tales</h2>
        </div>
        <div class="about-grid">
            <div class="about-text">
                <p><strong>Toast & Tales</strong> is an interactive Augmented Reality (AR) experience that brings the heritage of Singaporean breakfast to life.</p>
                <p>Using your smartphone, scan our specially designed posters to unlock 3D interactions. Pour the Kopi, spread the Kaya, and assemble the perfect Full Set Meal.</p>
                <p>Complete challenges, earn digital badges, and become a <em>Heritage Master</em>!</p>
            </div>
            
            <div class="about-image-container">
                <img src="images/logo_withoutBG.png" alt="Toast & Tales Badge" class="heritage-badge"> 
            </div>
        </div>
    </section>

    <div class="history-section">
        <section id="history">
            <div class="section-header">
                <h2>The Ya Kun Story</h2>
            </div>
            <div class="history-content">
                <p>It all began in 1944. Loi Ah Koon, a Hainanese immigrant, set up a humble coffee stall at Telok Ayer Basin. With just a charcoal grill and a pair of linen trousers, he served the community with warmth and dedication.</p>
                
                <div class="history-card">
                    <p>“The coffee brewed not just a beverage, but a bond between people. The kaya toast was not just breakfast, but a taste of home.”</p>
                </div>
                
                <p style="margin-top: 20px;">
                    Today, Ya Kun Kaya Toast is a symbol of Singapore's rich food heritage, preserving the traditional way of making coffee and toast for future generations.
                </p>
            </div>
        </section>
    </div>

    <footer>
        &copy; 2025 Toast & Tales Project. Not affiliated officially with Ya Kun Kaya Toast.
    </footer>

    <div id="loginModal" class="modal-overlay">
        <div class="modal-box">
            <span class="close-btn" onclick="closeLogin()">&times;</span>
            <h3>Player Login</h3>
            <form id="loginForm">
                <div class="input-group">
                    <input id="loginEmail" type="email" placeholder="Email" required>
                </div>
                <div class="input-group">
                    <input id="loginPassword" type="password" placeholder="Password" required>
                </div>
                <button type="submit" class="submit-btn">Log In</button>
            </form>
            <p style="font-size: 0.8rem; margin-top: 10px; color: #666;">
                Don't have an account? <a href="#" onclick="switchToSignup()" style="color: var(--yakun-brown); text-decoration: none; cursor: pointer;">Create one here!</a>
            </p>
        </div>
    </div>

    <div id="signupModal" class="modal-overlay">
        <div class="modal-box">
            <span class="close-btn" onclick="closeSignup()">&times;</span>
            <h3>Create Account</h3>
            <form id="signupForm">
                <div class="input-group">
                    <input id="signupEmail" type="email" placeholder="Email Address" required>
                </div>
                <div class="input-group">
                    <input id="signupPassword" type="password" placeholder="Password" required>
                </div>
                <div class="input-group">
                    <input id="signupConfirm" type="password" placeholder="Confirm Password" required>
                </div>
                <button type="submit" class="submit-btn">Sign Up</button>
            </form>
            <p style="font-size: 0.8rem; margin-top: 10px; color: #666;">
                Already have an account? <a href="#" onclick="switchToLogin()" style="color: var(--yakun-brown); text-decoration: none; cursor: pointer;">Log In</a>
            </p>
        </div>
    </div>

    <script>
        // --- CAROUSEL LOGIC ---
        // Handles the automatic sliding of heritage images
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        
        // Function to display a specific slide index
        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                }
            });
        }

        // Function to move to the next slide (loops back to start)
        function nextSlide() {
            currentSlide = (currentSlide + 1) % slides.length;
            showSlide(currentSlide);
        }

        // Auto-advance slides every 4 seconds
        setInterval(nextSlide, 4000);


        // --- MODAL LOGIC ---
        // Handles opening/closing of Login and Signup popups
        // Functions are attached to 'window' to be accessible globally
        
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        
        // Opens Login, ensures Signup is closed
        window.openLogin = function() { 
            console.log("Opening login modal");
            signupModal.style.display = 'none';
            loginModal.style.display = 'flex'; 
        };
        
        // Closes Login
        window.closeLogin = function() { 
            loginModal.style.display = 'none'; 
        };
        
        // Opens Signup, ensures Login is closed
        window.openSignup = function() { 
            loginModal.style.display = 'none';
            signupModal.style.display = 'flex'; 
        };
        
        // Closes Signup
        window.closeSignup = function() { 
            signupModal.style.display = 'none'; 
        };
        
        // Switchers for the "Already have an account?" links
        window.switchToLogin = function() {
            signupModal.style.display = 'none';
            loginModal.style.display = 'flex';
        };
        
        window.switchToSignup = function() {
            loginModal.style.display = 'none';
            signupModal.style.display = 'flex';
        };
        
        // Close modal if user clicks outside the box (on the overlay)
        window.onclick = function(event) { 
            if (event.target == loginModal) closeLogin();
            if (event.target == signupModal) closeSignup();
        }
    </script>
    
    <script type="module" src="firebase-init.js"></script>
    
    <script type="module">
        import { initAuth } from './auth.js';
        
        // Ensure DOM is ready before attaching auth listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, initializing auth...");
            initAuth();
        });
    </script>
</body>
</html>